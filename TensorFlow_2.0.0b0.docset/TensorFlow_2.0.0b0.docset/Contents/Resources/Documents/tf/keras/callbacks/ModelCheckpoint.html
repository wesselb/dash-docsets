<div itemscope="" itemtype="http://developers.google.com/ReferenceObject">
<p><meta itemprop="name" content="tf.keras.callbacks.ModelCheckpoint" /> <meta itemprop="path" content="Stable" /> <meta itemprop="property" content="__init__"/> <meta itemprop="property" content="on_batch_begin"/> <meta itemprop="property" content="on_batch_end"/> <meta itemprop="property" content="on_epoch_begin"/> <meta itemprop="property" content="on_epoch_end"/> <meta itemprop="property" content="on_predict_batch_begin"/> <meta itemprop="property" content="on_predict_batch_end"/> <meta itemprop="property" content="on_predict_begin"/> <meta itemprop="property" content="on_predict_end"/> <meta itemprop="property" content="on_test_batch_begin"/> <meta itemprop="property" content="on_test_batch_end"/> <meta itemprop="property" content="on_test_begin"/> <meta itemprop="property" content="on_test_end"/> <meta itemprop="property" content="on_train_batch_begin"/> <meta itemprop="property" content="on_train_batch_end"/> <meta itemprop="property" content="on_train_begin"/> <meta itemprop="property" content="on_train_end"/> <meta itemprop="property" content="set_model"/> <meta itemprop="property" content="set_params"/></p>
</div>
<a name="//apple_ref/cpp/Class/tf.keras.callbacks.ModelCheckpoint" class="dashAnchor"></a><h1 id="tf.keras.callbacks.modelcheckpoint">tf.keras.callbacks.ModelCheckpoint</h1>
<h2 id="class-modelcheckpoint">Class <code>ModelCheckpoint</code></h2>
<p>Save the model after every epoch.</p>
<p>Inherits From: <a href="../../../tf/keras/callbacks/Callback.html"><code>Callback</code></a></p>
<h3 id="aliases">Aliases:</h3>
<ul>
<li>Class <code>tf.compat.v1.keras.callbacks.ModelCheckpoint</code></li>
<li>Class <code>tf.compat.v2.keras.callbacks.ModelCheckpoint</code></li>
<li>Class <code>tf.keras.callbacks.ModelCheckpoint</code></li>
</ul>
<p>Defined in <a href="/code/stable/tensorflow/python/keras/callbacks.py"><code>python/keras/callbacks.py</code></a>.</p>
<!-- Placeholder for "Used in" -->
<p><code>filepath</code> can contain named formatting options, which will be filled the value of <code>epoch</code> and keys in <code>logs</code> (passed in <code>on_epoch_end</code>).</p>
<p>For example: if <code>filepath</code> is <code>weights.{epoch:02d}-{val_loss:.2f}.hdf5</code>, then the model checkpoints will be saved with the epoch number and the validation loss in the filename.</p>
<h4 id="arguments">Arguments:</h4>
<ul>
<li><b><code>filepath</code></b>: string, path to save the model file.</li>
<li><b><code>monitor</code></b>: quantity to monitor.</li>
<li><b><code>verbose</code></b>: verbosity mode, 0 or 1.</li>
<li><b><code>save_best_only</code></b>: if <code>save_best_only=True</code>, the latest best model according to the quantity monitored will not be overwritten.</li>
<li><b><code>mode</code></b>: one of {auto, min, max}. If <code>save_best_only=True</code>, the decision to overwrite the current save file is made based on either the maximization or the minimization of the monitored quantity. For <code>val_acc</code>, this should be <code>max</code>, for <code>val_loss</code> this should be <code>min</code>, etc. In <code>auto</code> mode, the direction is automatically inferred from the name of the monitored quantity.</li>
<li><b><code>save_weights_only</code></b>: if True, then only the model's weights will be saved (<code>model.save_weights(filepath)</code>), else the full model is saved (<code>model.save(filepath)</code>).</li>
<li><b><code>save_freq</code></b>: <code>'epoch'</code> or integer. When using <code>'epoch'</code>, the callback saves the model after each epoch. When using integer, the callback saves the model at end of a batch at which this many samples have been seen since last saving. Note that if the saving isn't aligned to epochs, the monitored metric may potentially be less reliable (it could reflect as little as 1 batch, since the metrics get reset every epoch). Defaults to <code>'epoch'</code></li>
<li><b><code>load_weights_on_restart</code></b>: Whether the training should restore the model. If True, the model will attempt to load the checkpoint file from <code>filepath</code> at the start of <code>model.fit()</code>. This saves the need of manually calling <code>model.load_weights()</code> before `model.fit(). In multi-worker distributed training, this provides fault-tolerance and loads the model automatically upon recovery of workers. The callback gives up loading if the filepath does not exist, and raises ValueError if format does not match. Defaults to False.</li>
<li><b><code>**kwargs</code></b>: Additional arguments for backwards compatibility. Possible key is <code>period</code>.</li>
</ul>
<h2 id="__init__">
<code><strong>init</strong></code>
</h2>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="fu">__init__</span>(
    filepath,
    monitor<span class="op">=</span><span class="st">&#39;val_loss&#39;</span>,
    verbose<span class="op">=</span><span class="dv">0</span>,
    save_best_only<span class="op">=</span><span class="va">False</span>,
    save_weights_only<span class="op">=</span><span class="va">False</span>,
    mode<span class="op">=</span><span class="st">&#39;auto&#39;</span>,
    save_freq<span class="op">=</span><span class="st">&#39;epoch&#39;</span>,
    load_weights_on_restart<span class="op">=</span><span class="va">False</span>,
    <span class="op">**</span>kwargs
)</code></pre></div>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<h2 id="methods">Methods</h2>
<h3 id="on_batch_begin">
<code>on_batch_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_batch_begin(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>A backwards compatibility alias for <code>on_train_batch_begin</code>.</p>
<h3 id="on_batch_end">
<code>on_batch_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_batch_end(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>A backwards compatibility alias for <code>on_train_batch_end</code>.</p>
<h3 id="on_epoch_begin">
<code>on_epoch_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_epoch_begin(
    epoch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the start of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only be called during TRAIN mode.</p>
<h4 id="arguments-1">Arguments:</h4>
<ul>
<li><b><code>epoch</code></b>: integer, index of epoch.</li>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="on_epoch_end">
<code>on_epoch_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_epoch_end(
    epoch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only be called during TRAIN mode.</p>
<h4 id="arguments-2">Arguments:</h4>
<ul>
<li><b><code>epoch</code></b>: integer, index of epoch.</li>
<li><b><code>logs</code></b>: dict, metric results for this training epoch, and for the validation epoch if validation is performed. Validation result keys are prefixed with <code>val_</code>.</li>
</ul>
<h3 id="on_predict_batch_begin">
<code>on_predict_batch_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_predict_batch_begin(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the beginning of a batch in <code>predict</code> methods.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-3">Arguments:</h4>
<ul>
<li><b><code>batch</code></b>: integer, index of batch within the current epoch.</li>
<li><b><code>logs</code></b>: dict. Has keys <code>batch</code> and <code>size</code> representing the current batch number and the size of the batch.</li>
</ul>
<h3 id="on_predict_batch_end">
<code>on_predict_batch_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_predict_batch_end(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the end of a batch in <code>predict</code> methods.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-4">Arguments:</h4>
<ul>
<li><b><code>batch</code></b>: integer, index of batch within the current epoch.</li>
<li><b><code>logs</code></b>: dict. Metric results for this batch.</li>
</ul>
<h3 id="on_predict_begin">
<code>on_predict_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_predict_begin(logs<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>Called at the beginning of prediction.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-5">Arguments:</h4>
<ul>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="on_predict_end">
<code>on_predict_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_predict_end(logs<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>Called at the end of prediction.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-6">Arguments:</h4>
<ul>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="on_test_batch_begin">
<code>on_test_batch_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_test_batch_begin(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the beginning of a batch in <code>evaluate</code> methods.</p>
<p>Also called at the beginning of a validation batch in the <code>fit</code> methods, if validation data is provided.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-7">Arguments:</h4>
<ul>
<li><b><code>batch</code></b>: integer, index of batch within the current epoch.</li>
<li><b><code>logs</code></b>: dict. Has keys <code>batch</code> and <code>size</code> representing the current batch number and the size of the batch.</li>
</ul>
<h3 id="on_test_batch_end">
<code>on_test_batch_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_test_batch_end(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the end of a batch in <code>evaluate</code> methods.</p>
<p>Also called at the end of a validation batch in the <code>fit</code> methods, if validation data is provided.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-8">Arguments:</h4>
<ul>
<li><b><code>batch</code></b>: integer, index of batch within the current epoch.</li>
<li><b><code>logs</code></b>: dict. Metric results for this batch.</li>
</ul>
<h3 id="on_test_begin">
<code>on_test_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_test_begin(logs<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>Called at the beginning of evaluation or validation.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-9">Arguments:</h4>
<ul>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="on_test_end">
<code>on_test_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_test_end(logs<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>Called at the end of evaluation or validation.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-10">Arguments:</h4>
<ul>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="on_train_batch_begin">
<code>on_train_batch_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_train_batch_begin(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the beginning of a training batch in <code>fit</code> methods.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-11">Arguments:</h4>
<ul>
<li><b><code>batch</code></b>: integer, index of batch within the current epoch.</li>
<li><b><code>logs</code></b>: dict. Has keys <code>batch</code> and <code>size</code> representing the current batch number and the size of the batch.</li>
</ul>
<h3 id="on_train_batch_end">
<code>on_train_batch_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_train_batch_end(
    batch,
    logs<span class="op">=</span><span class="va">None</span>
)</code></pre></div>
<p>Called at the end of a training batch in <code>fit</code> methods.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-12">Arguments:</h4>
<ul>
<li><b><code>batch</code></b>: integer, index of batch within the current epoch.</li>
<li><b><code>logs</code></b>: dict. Metric results for this batch.</li>
</ul>
<h3 id="on_train_begin">
<code>on_train_begin</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_train_begin(logs<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>Called at the beginning of training.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-13">Arguments:</h4>
<ul>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="on_train_end">
<code>on_train_end</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">on_train_end(logs<span class="op">=</span><span class="va">None</span>)</code></pre></div>
<p>Called at the end of training.</p>
<p>Subclasses should override for any actions to run.</p>
<h4 id="arguments-14">Arguments:</h4>
<ul>
<li><b><code>logs</code></b>: dict. Currently no data is passed to this argument for this method but that may change in the future.</li>
</ul>
<h3 id="set_model">
<code>set_model</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">set_model(model)</code></pre></div>
<h3 id="set_params">
<code>set_params</code>
</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">set_params(params)</code></pre></div>
